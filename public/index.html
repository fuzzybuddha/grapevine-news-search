<!DOCTYPE html>
<html lang="en-US">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css">
    <link href="./css/bootstrap.min.css" rel="stylesheet">
    <link href="./css/leaflet.css" rel="stylesheet">
    <link href="./css/select.css" rel="stylesheet">
    <link href="./css/grapevine.css" rel="stylesheet">
    <link href="./css/news.css" rel="stylesheet">
    <!--script type="text/javascript" src="./js/jquery.js"></script-->
    <!--script type="text/javascript" src="./js/bootstrap.min.js"></script-->
</head>

<body ng-app="grapevine" ng-controller="SocketController as socket">
    <div class="container">
        <div class="row">
            <div class="col-xs-2">
                <a href="/"><img class="gv-logo" src="img/grapevineLogo.png"></a>
            </div>
            <div class="col-xs-9 col-xs-offset-1">
                <ul class="country-tags">
                    <li>
                        <a href="#" ng-show="country.checked" ng-repeat="country in socket.countries" ng-model="socket.countries" class="country-tag" ng-click="countryClick(country)">
                            <i class="fa fa-times"></i> {{country.name}}
                        </a>
                    </li>
                </ul>
            </div>
        </div>
        <div class="row">
            <hr>
        </div>
        <div ng-show="displaySearch" class="col-xs-12 text-center description">
            Search for news stories in other languages around the world. Choose a few countries and enter your query at the bottom of the page.
        </div>
    

    <div class="row spacer" ng-show="displaySearch" ng-init="displaySearch=true">
        <div class="col-xs-12 col-xs-offset-0 col-md-10 col-md-offset-1">
            <div class="row spacer">
                <div class="col-xs-6 col-xs-offset-3 col-sm-3 col-sm-offset-0">
                    <div class="country-input">
                        <input ng-change="updateList(countryInput)" type="text" ng-model="countryInput" class="form-control" placeholder="Country...">
                    </div>
                    <div class="country-list" id="country_list">
                        <div>
                            <ul ng-show="country.display" ng-init="country.display=true" ng-repeat="country in socket.countries" ng-model="socket.countries" class="list-group">
                                <li ng-click="countryClick(country)" ng-init="country.checked=false" class="list-group-item inline">
                                    <i ng-class="isChecked(country)"></i>
                                    <label class="country-names">
                                        {{country.name}}
                                    </label>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
                <div class="hidden-xs col-sm-9">
                    <div id="map"></div>
                </div>
            </div>
            <div class="row spacer">
                <div class="col-xs-6 col-sm-9 col-xs-offset-3 text-center">
                    <div class="input-group">
                        <input ng-model="searchQuery" type="text" class="form-control" placeholder="Search countries for...">
                        <span class="input-group-btn">
                                <button ng-click="go(searchQuery)" class="btn btn-primary" type="button">Go!</button>
                        </span>
                    </div>
                    <!-- /input-group -->
                </div>
            </div>
            {{countryInput}}
        </div>
    </div>

    <a href="#">
        <div ng-click="displaySelectionAlert=!displaySelectionAlert" ng-init="displaySelectionAlert=false" ng-show="displaySelectionAlert" class="country-selection-alert">
            <i class="fa fa-times fa-lg"></i>    Sorry, grapevine currently only supports three countries at a time.
        </div>
    </a>
    <div ng-class="text-center" class="loading-spinner" ng-show="displayLoading()">
        <img src="img/preloader.gif"></img>
    </div>
    <div class="row" ng-hide="displaySearch">
            <div ng-repeat="searchedCountry in socket.news" ng-class="columns()">
            <div class="news-panel">
                <div class="news-wrapper">
                    <h3 class="indent">{{titleCase(socket.countries[searchedCountry.country_code].name)}}</h3>
                    <div class="country-news">
                        <div ng-repeat="newsStory in searchedCountry['news']" class="news-story">
                            <h4 ng-bind-html-unsafe='newsStory["title"]'></h4>
                            <p>{{newsStory["summary"]}}</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    </div>
    <script type="text/javascript" src="./js/leaflet.js"></script>
    <script type="text/javascript" src="./js/countries-map.js"></script>
    <script type="text/javascript" src="./js/angular.min.js"></script>
    <script type="text/javascript" src="./js/ui-bootstrap.min.js"></script>
    <script src="https://cdn.socket.io/socket.io-1.3.5.js"></script>
    <script type="text/javascript" src="./js/grapevine-ng.js"></script>
</body>

</html>
